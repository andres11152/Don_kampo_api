{"version":3,"file":"uploadImage.js","names":["_clientS","require","_mimeTypes","_nanoid","s3Client","S3Client","region","process","env","AWS_REGION","credentials","accessKeyId","AWS_ACCESS_KEY_ID","secretAccessKey","AWS_SECRET_ACCESS_KEY","uploadImage","buffer","fileName","mimeType","lookup","uniqueFileName","nanoid","uploadParams","Bucket","AWS_BUCKET_NAME","Key","Body","ContentType","data","send","PutObjectCommand","console","log","error","Error","message","exports"],"sources":["../../src/helpers/uploadImage.js"],"sourcesContent":["import { S3Client, PutObjectCommand } from '@aws-sdk/client-s3';\r\nimport { lookup } from 'mime-types';\r\nimport { nanoid } from 'nanoid';\r\n\r\nconst s3Client = new S3Client({\r\n  region: process.env.AWS_REGION,\r\n  credentials: {\r\n    accessKeyId: process.env.AWS_ACCESS_KEY_ID,\r\n    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY,\r\n  },\r\n});\r\n\r\nexport const uploadImage = async (buffer, fileName) => {\r\n  try {\r\n \r\n    const mimeType = lookup(fileName) || 'application/octet-stream';\r\n    const uniqueFileName = `${nanoid()}-${fileName}`;\r\n    const uploadParams = {\r\n      Bucket: process.env.AWS_BUCKET_NAME,\r\n      Key: `images/${uniqueFileName}`,\r\n      Body: buffer,\r\n      ContentType: mimeType,\r\n    };\r\n\r\n    const data = await s3Client.send(new PutObjectCommand(uploadParams));\r\n\r\n    console.log('Imagen subida exitosamente:', data);\r\n\r\n    return `https://${process.env.AWS_BUCKET_NAME}.s3.${process.env.AWS_REGION}.amazonaws.com/${uploadParams.Key}`;\r\n  } catch (error) {\r\n    console.error('Error al subir la imagen a S3:', error);\r\n    throw new Error(`Error al subir la imagen a S3: ${error.message}`);\r\n  }\r\n};\r\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,UAAA,GAAAD,OAAA;AACA,IAAAE,OAAA,GAAAF,OAAA;AAEA,MAAMG,QAAQ,GAAG,IAAIC,iBAAQ,CAAC;EAC5BC,MAAM,EAAEC,OAAO,CAACC,GAAG,CAACC,UAAU;EAC9BC,WAAW,EAAE;IACXC,WAAW,EAAEJ,OAAO,CAACC,GAAG,CAACI,iBAAiB;IAC1CC,eAAe,EAAEN,OAAO,CAACC,GAAG,CAACM;EAC/B;AACF,CAAC,CAAC;AAEK,MAAMC,WAAW,GAAG,MAAAA,CAAOC,MAAM,EAAEC,QAAQ,KAAK;EACrD,IAAI;IAEF,MAAMC,QAAQ,GAAG,IAAAC,iBAAM,EAACF,QAAQ,CAAC,IAAI,0BAA0B;IAC/D,MAAMG,cAAc,GAAG,GAAG,IAAAC,cAAM,EAAC,CAAC,IAAIJ,QAAQ,EAAE;IAChD,MAAMK,YAAY,GAAG;MACnBC,MAAM,EAAEhB,OAAO,CAACC,GAAG,CAACgB,eAAe;MACnCC,GAAG,EAAE,UAAUL,cAAc,EAAE;MAC/BM,IAAI,EAAEV,MAAM;MACZW,WAAW,EAAET;IACf,CAAC;IAED,MAAMU,IAAI,GAAG,MAAMxB,QAAQ,CAACyB,IAAI,CAAC,IAAIC,yBAAgB,CAACR,YAAY,CAAC,CAAC;IAEpES,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAEJ,IAAI,CAAC;IAEhD,OAAO,WAAWrB,OAAO,CAACC,GAAG,CAACgB,eAAe,OAAOjB,OAAO,CAACC,GAAG,CAACC,UAAU,kBAAkBa,YAAY,CAACG,GAAG,EAAE;EAChH,CAAC,CAAC,OAAOQ,KAAK,EAAE;IACdF,OAAO,CAACE,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;IACtD,MAAM,IAAIC,KAAK,CAAC,kCAAkCD,KAAK,CAACE,OAAO,EAAE,CAAC;EACpE;AACF,CAAC;AAACC,OAAA,CAAArB,WAAA,GAAAA,WAAA","ignoreList":[]}