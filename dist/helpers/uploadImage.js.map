{"version":3,"file":"uploadImage.js","names":["S3Client","PutObjectCommand","lookup","nanoid","s3Client","region","process","env","AWS_REGION","credentials","accessKeyId","AWS_ACCESS_KEY_ID","secretAccessKey","AWS_SECRET_ACCESS_KEY","uploadImage","buffer","fileName","mimeType","uniqueFileName","uploadParams","Bucket","AWS_BUCKET_NAME","Key","Body","ContentType","data","send","console","log","error","Error","message"],"sources":["../../src/helpers/uploadImage.js"],"sourcesContent":["import { S3Client, PutObjectCommand } from '@aws-sdk/client-s3';\r\nimport { lookup } from 'mime-types';\r\nimport { nanoid } from 'nanoid';\r\n\r\nconst s3Client = new S3Client({\r\n  region: process.env.AWS_REGION,\r\n  credentials: {\r\n    accessKeyId: process.env.AWS_ACCESS_KEY_ID,\r\n    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY,\r\n  },\r\n});\r\n\r\nexport const uploadImage = async (buffer, fileName) => {\r\n  try {\r\n \r\n    const mimeType = lookup(fileName) || 'application/octet-stream';\r\n    const uniqueFileName = `${nanoid()}-${fileName}`;\r\n    const uploadParams = {\r\n      Bucket: process.env.AWS_BUCKET_NAME,\r\n      Key: `images/${uniqueFileName}`,\r\n      Body: buffer,\r\n      ContentType: mimeType,\r\n    };\r\n\r\n    const data = await s3Client.send(new PutObjectCommand(uploadParams));\r\n\r\n    console.log('Imagen subida exitosamente:', data);\r\n\r\n    return `https://${process.env.AWS_BUCKET_NAME}.s3.${process.env.AWS_REGION}.amazonaws.com/${uploadParams.Key}`;\r\n  } catch (error) {\r\n    console.error('Error al subir la imagen a S3:', error);\r\n    throw new Error(`Error al subir la imagen a S3: ${error.message}`);\r\n  }\r\n};\r\n"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,gBAAgB,QAAQ,oBAAoB;AAC/D,SAASC,MAAM,QAAQ,YAAY;AACnC,SAASC,MAAM,QAAQ,QAAQ;AAE/B,MAAMC,QAAQ,GAAG,IAAIJ,QAAQ,CAAC;EAC5BK,MAAM,EAAEC,OAAO,CAACC,GAAG,CAACC,UAAU;EAC9BC,WAAW,EAAE;IACXC,WAAW,EAAEJ,OAAO,CAACC,GAAG,CAACI,iBAAiB;IAC1CC,eAAe,EAAEN,OAAO,CAACC,GAAG,CAACM;EAC/B;AACF,CAAC,CAAC;AAEF,OAAO,MAAMC,WAAW,GAAG,MAAAA,CAAOC,MAAM,EAAEC,QAAQ,KAAK;EACrD,IAAI;IAEF,MAAMC,QAAQ,GAAGf,MAAM,CAACc,QAAQ,CAAC,IAAI,0BAA0B;IAC/D,MAAME,cAAc,GAAG,GAAGf,MAAM,CAAC,CAAC,IAAIa,QAAQ,EAAE;IAChD,MAAMG,YAAY,GAAG;MACnBC,MAAM,EAAEd,OAAO,CAACC,GAAG,CAACc,eAAe;MACnCC,GAAG,EAAE,UAAUJ,cAAc,EAAE;MAC/BK,IAAI,EAAER,MAAM;MACZS,WAAW,EAAEP;IACf,CAAC;IAED,MAAMQ,IAAI,GAAG,MAAMrB,QAAQ,CAACsB,IAAI,CAAC,IAAIzB,gBAAgB,CAACkB,YAAY,CAAC,CAAC;IAEpEQ,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAEH,IAAI,CAAC;IAEhD,OAAO,WAAWnB,OAAO,CAACC,GAAG,CAACc,eAAe,OAAOf,OAAO,CAACC,GAAG,CAACC,UAAU,kBAAkBW,YAAY,CAACG,GAAG,EAAE;EAChH,CAAC,CAAC,OAAOO,KAAK,EAAE;IACdF,OAAO,CAACE,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;IACtD,MAAM,IAAIC,KAAK,CAAC,kCAAkCD,KAAK,CAACE,OAAO,EAAE,CAAC;EACpE;AACF,CAAC","ignoreList":[]}