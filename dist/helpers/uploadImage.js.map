{"version":3,"file":"uploadImage.js","names":["S3Client","PutObjectCommand","lookup","nanoid","s3Client","region","process","env","AWS_REGION","credentials","accessKeyId","AWS_ACCESS_KEY_ID","secretAccessKey","AWS_SECRET_ACCESS_KEY","uploadImage","_ref","_asyncToGenerator","buffer","fileName","mimeType","uniqueFileName","uploadParams","Bucket","AWS_BUCKET_NAME","Key","Body","ContentType","data","send","console","log","error","Error","message","_x","_x2","apply","arguments"],"sources":["../../src/helpers/uploadImage.js"],"sourcesContent":["import { S3Client, PutObjectCommand } from '@aws-sdk/client-s3';\r\nimport { lookup } from 'mime-types';\r\nimport { nanoid } from 'nanoid';\r\n\r\nconst s3Client = new S3Client({\r\n  region: process.env.AWS_REGION,\r\n  credentials: {\r\n    accessKeyId: process.env.AWS_ACCESS_KEY_ID,\r\n    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY,\r\n  },\r\n});\r\n\r\nexport const uploadImage = async (buffer, fileName) => {\r\n  try {\r\n \r\n    const mimeType = lookup(fileName) || 'application/octet-stream';\r\n    const uniqueFileName = `${nanoid()}-${fileName}`;\r\n    const uploadParams = {\r\n      Bucket: process.env.AWS_BUCKET_NAME,\r\n      Key: `images/${uniqueFileName}`,\r\n      Body: buffer,\r\n      ContentType: mimeType,\r\n    };\r\n\r\n    const data = await s3Client.send(new PutObjectCommand(uploadParams));\r\n\r\n    console.log('Imagen subida exitosamente:', data);\r\n\r\n    return `https://${process.env.AWS_BUCKET_NAME}.s3.${process.env.AWS_REGION}.amazonaws.com/${uploadParams.Key}`;\r\n  } catch (error) {\r\n    console.error('Error al subir la imagen a S3:', error);\r\n    throw new Error(`Error al subir la imagen a S3: ${error.message}`);\r\n  }\r\n};\r\n"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,gBAAgB,QAAQ,oBAAoB;AAC/D,SAASC,MAAM,QAAQ,YAAY;AACnC,SAASC,MAAM,QAAQ,QAAQ;AAE/B,MAAMC,QAAQ,GAAG,IAAIJ,QAAQ,CAAC;EAC5BK,MAAM,EAAEC,OAAO,CAACC,GAAG,CAACC,UAAU;EAC9BC,WAAW,EAAE;IACXC,WAAW,EAAEJ,OAAO,CAACC,GAAG,CAACI,iBAAiB;IAC1CC,eAAe,EAAEN,OAAO,CAACC,GAAG,CAACM;EAC/B;AACF,CAAC,CAAC;AAEF,OAAO,MAAMC,WAAW;EAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAG,WAAOC,MAAM,EAAEC,QAAQ,EAAK;IACrD,IAAI;MAEF,MAAMC,QAAQ,GAAGjB,MAAM,CAACgB,QAAQ,CAAC,IAAI,0BAA0B;MAC/D,MAAME,cAAc,GAAG,GAAGjB,MAAM,CAAC,CAAC,IAAIe,QAAQ,EAAE;MAChD,MAAMG,YAAY,GAAG;QACnBC,MAAM,EAAEhB,OAAO,CAACC,GAAG,CAACgB,eAAe;QACnCC,GAAG,EAAE,UAAUJ,cAAc,EAAE;QAC/BK,IAAI,EAAER,MAAM;QACZS,WAAW,EAAEP;MACf,CAAC;MAED,MAAMQ,IAAI,SAASvB,QAAQ,CAACwB,IAAI,CAAC,IAAI3B,gBAAgB,CAACoB,YAAY,CAAC,CAAC;MAEpEQ,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAEH,IAAI,CAAC;MAEhD,OAAO,WAAWrB,OAAO,CAACC,GAAG,CAACgB,eAAe,OAAOjB,OAAO,CAACC,GAAG,CAACC,UAAU,kBAAkBa,YAAY,CAACG,GAAG,EAAE;IAChH,CAAC,CAAC,OAAOO,KAAK,EAAE;MACdF,OAAO,CAACE,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;MACtD,MAAM,IAAIC,KAAK,CAAC,kCAAkCD,KAAK,CAACE,OAAO,EAAE,CAAC;IACpE;EACF,CAAC;EAAA,gBArBYnB,WAAWA,CAAAoB,EAAA,EAAAC,GAAA;IAAA,OAAApB,IAAA,CAAAqB,KAAA,OAAAC,SAAA;EAAA;AAAA,GAqBvB","ignoreList":[]}