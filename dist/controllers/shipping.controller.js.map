{"version":3,"file":"shipping.controller.js","names":["getConnection","queries","createShippingInfo","req","res","shipping_method","tracking_number","estimated_delivery","actual_delivery","shipping_status_id","body","status","json","msg","client","query","shipping_info","order_id","release","error","console","getShippingInfo","result","rows","getShippingInfoById","id","params","length","updateShippingInfo","rowCount","deleteShippingInfo"],"sources":["../../src/controllers/shipping.controller.js"],"sourcesContent":["// Importar el pool y las queries\r\nimport { getConnection } from \"../database/connection.js\";\r\nimport { queries } from \"../database/queries.interface.js\";\r\n\r\n// Crear nueva información de envío\r\nexport const createShippingInfo = async (req, res) => {\r\n  const {\r\n    shipping_method,\r\n    tracking_number,\r\n    estimated_delivery,\r\n    actual_delivery,\r\n    shipping_status_id,\r\n  } = req.body;\r\n\r\n  // Validación de campos obligatorios\r\n  if (!shipping_method || !shipping_status_id) {\r\n    return res.status(400).json({\r\n      msg: \"Faltan campos obligatorios: shipping_method o shipping_status_id.\",\r\n    });\r\n  }\r\n\r\n  try {\r\n    const client = await getConnection();\r\n    await client.query(queries.shipping_info.createShippingInfo, [\r\n      shipping_method,\r\n      tracking_number,\r\n      estimated_delivery,\r\n      actual_delivery,\r\n      shipping_status_id,\r\n      order_id\r\n    ]);\r\n\r\n    client.release();\r\n\r\n    return res.status(201).json({\r\n      msg: \"Información de envío creada con éxito\",\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Error al crear la información de envío:\", error); // Log del error\r\n    return res.status(500).json({\r\n      msg: \"Error al crear la información de envío\",\r\n    });\r\n  }\r\n};\r\n\r\n// Obtener toda la información de envíos\r\nexport const getShippingInfo = async (req, res) => {\r\n  try {\r\n    const client = await getConnection();\r\n    const result = await client.query(queries.shipping_info.getShippingInfo);\r\n\r\n    client.release();\r\n\r\n    return res.status(200).json(result.rows);\r\n  } catch (error) {\r\n    console.error(\"Error al obtener la información de envíos:\", error);\r\n    return res.status(500).json({\r\n      msg: \"Error al obtener la información de envíos\",\r\n    });\r\n  }\r\n};\r\n\r\n// Obtener información de envío por ID\r\nexport const getShippingInfoById = async (req, res) => {\r\n  const { id } = req.params;\r\n\r\n  try {\r\n    const client = await getConnection();\r\n    const result = await client.query(queries.shipping_info.getShippingInfoById, [\r\n      id,\r\n    ]);\r\n\r\n    client.release();\r\n\r\n    if (result.rows.length === 0) {\r\n      return res.status(404).json({ msg: \"Información de envío no encontrada\" });\r\n    }\r\n\r\n    return res.status(200).json(result.rows[0]);\r\n  } catch (error) {\r\n    console.error(\"Error al obtener la información de envío:\", error);\r\n    return res.status(500).json({\r\n      msg: \"Error al obtener la información de envío\",\r\n    });\r\n  }\r\n};\r\n\r\n// Actualizar información de envío\r\nexport const updateShippingInfo = async (req, res) => {\r\n  const { id } = req.params;\r\n  const {\r\n    shipping_method,\r\n    tracking_number,\r\n    estimated_delivery,\r\n    actual_delivery,\r\n    shipping_status_id,\r\n  } = req.body;\r\n\r\n  // Validación de campos obligatorios\r\n  if (!shipping_method || !shipping_status_id) {\r\n    return res.status(400).json({\r\n      msg: \"Faltan campos obligatorios: shipping_method o shipping_status_id.\",\r\n    });\r\n  }\r\n\r\n  try {\r\n    const client = await getConnection();\r\n    const result = await client.query(queries.shipping_info.updateShippingInfo, [\r\n      shipping_method,\r\n      tracking_number,\r\n      estimated_delivery,\r\n      actual_delivery,\r\n      shipping_status_id,\r\n      id,\r\n    ]);\r\n\r\n    client.release();\r\n\r\n    if (result.rowCount === 0) {\r\n      return res.status(404).json({ msg: \"Información de envío no encontrada\" });\r\n    }\r\n\r\n    return res.status(200).json({\r\n      msg: \"Información de envío actualizada con éxito\",\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Error al actualizar la información de envío:\", error);\r\n    return res.status(500).json({\r\n      msg: \"Error al actualizar la información de envío\",\r\n    });\r\n  }\r\n};\r\n\r\n// Eliminar información de envío\r\nexport const deleteShippingInfo = async (req, res) => {\r\n  const { id } = req.params;\r\n\r\n  try {\r\n    const client = await getConnection();\r\n    const result = await client.query(queries.shipping_info.deleteShippingInfo, [\r\n      id,\r\n    ]);\r\n\r\n    client.release();\r\n\r\n    if (result.rowCount === 0) {\r\n      return res.status(404).json({ msg: \"Información de envío no encontrada\" });\r\n    }\r\n\r\n    return res.status(200).json({\r\n      msg: \"Información de envío eliminada con éxito\",\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Error al eliminar la información de envío:\", error);\r\n    return res.status(500).json({\r\n      msg: \"Error al eliminar la información de envío\",\r\n    });\r\n  }\r\n};\r\n"],"mappings":"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","ignoreList":[]}