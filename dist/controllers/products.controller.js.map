{"version":3,"file":"products.controller.js","names":["_connection","require","_uploadImage","_queriesInterface","getProducts","req","res","page","limit","query","offset","client","getConnection","productsResult","queries","products","rows","length","status","json","message","productsWithVariations","forEach","row","existingProduct","find","product","product_id","variations","push","variation_id","quality","quantity","price_home","price_supermarket","price_restaurant","price_fruver","name","description","category","stock","photo_url","error","console","release","exports","getProductById","id","params","productResult","variationsResult","getProductVariations","productWithVariations","createProduct","_req$file","body","photoBuffer","file","buffer","defaultPhotoUrl","photoUrl","uploadImage","originalname","validatedStock","parseInt","result","productId","Array","isArray","variation","createProductVariation","parseFloat","uploadImageSafe","filename","updateProduct","parsedProductId","isNaN","updatedPhotoUrl","rowCount","deleteProductVariation","deleteProduct"],"sources":["../../src/controllers/products.controller.js"],"sourcesContent":["import { getConnection } from '../database/connection.js';\r\nimport { uploadImage } from '../helpers/uploadImage.js'; \r\nimport { queries } from '../database/queries.interface.js';\r\n\r\nexport const getProducts = async (req, res) => {\r\n  const { page = 1, limit = 9 } = req.query;\r\n  const offset = (page - 1) * limit;\r\n\r\n  let client;\r\n  try {\r\n    client = await getConnection();\r\n\r\n    const productsResult = await client.query(queries.products.getProducts, [offset, limit]);\r\n\r\n    if (productsResult.rows.length === 0) {\r\n      return res.status(404).json({ message: 'No hay productos disponibles' });\r\n    }\r\n\r\n    const productsWithVariations = [];\r\n\r\n    productsResult.rows.forEach((row) => {\r\n      const existingProduct = productsWithVariations.find((product) => product.product_id === row.product_id);\r\n\r\n      if (existingProduct) {\r\n        existingProduct.variations.push({\r\n          variation_id: row.variation_id,\r\n          quality: row.quality,\r\n          quantity: row.quantity,\r\n          price_home: row.price_home,\r\n          price_supermarket: row.price_supermarket,\r\n          price_restaurant: row.price_restaurant,\r\n          price_fruver: row.price_fruver,\r\n        });\r\n      } else {\r\n        productsWithVariations.push({\r\n          product_id: row.product_id,\r\n          name: row.name,\r\n          description: row.description,\r\n          category: row.category,\r\n          stock: row.stock,\r\n          photo_url: row.photo_url,\r\n          variations: row.variation_id\r\n            ? [\r\n                {\r\n                  variation_id: row.variation_id,\r\n                  quality: row.quality,\r\n                  quantity: row.quantity,\r\n                  price_home: row.price_home,\r\n                  price_supermarket: row.price_supermarket,\r\n                  price_restaurant: row.price_restaurant,\r\n                  price_fruver: row.price_fruver,\r\n                },\r\n              ]\r\n            : [],\r\n        });\r\n      }\r\n    });\r\n\r\n    res.status(200).json(productsWithVariations);\r\n\r\n  } catch (error) {\r\n    console.error('Error al obtener los productos:', error);\r\n    res.status(500).json({ message: 'Error al obtener los productos' });\r\n  } finally {\r\n    if (client) client.release();\r\n  }\r\n};\r\n\r\nexport const getProductById = async (req, res) => {\r\n  const { id } = req.params;  \r\n\r\n  let client;\r\n  try {\r\n    client = await getConnection();  \r\n\r\n    const productResult = await client.query(queries.products.getProductById, [id]);\r\n\r\n    if (productResult.rows.length === 0) {\r\n      return res.status(404).json({ message: 'Producto no encontrado' });\r\n    }\r\n\r\n    const variationsResult = await client.query(queries.products.getProductVariations, [id]);\r\n  \r\n    const productWithVariations = {\r\n      ...productResult.rows[0], \r\n      variations: variationsResult.rows  \r\n    };\r\n\r\n    res.status(200).json(productWithVariations);\r\n  } catch (error) {\r\n    console.error('Error al obtener el producto por ID:', error);\r\n    res.status(500).json({ message: 'Error al obtener el producto' });\r\n  } finally {\r\n    if (client) client.release();  \r\n  }\r\n};\r\n\r\nexport const createProduct = async (req, res) => {\r\n  let client;\r\n\r\n  const { name, description, category, stock, variations } = req.body;\r\n\r\n  const photoBuffer = req.file?.buffer || null;\r\n  const defaultPhotoUrl = 'https://example.com/default-image.jpg';\r\n  let photoUrl = null;\r\n\r\n  if (photoBuffer) {\r\n    try {\r\n      photoUrl = await uploadImage(photoBuffer, req.file.originalname);\r\n    } catch (error) {\r\n      return res.status(500).json({ message: 'Error al subir la imagen a S3' });\r\n    }\r\n  } else {\r\n    photoUrl = defaultPhotoUrl;\r\n  }\r\n\r\n  const validatedStock = stock ? parseInt(stock, 10) : 0;\r\n\r\n  try {\r\n    client = await getConnection();\r\n\r\n    const result = await client.query(queries.products.createProduct, [\r\n      name,\r\n      description,\r\n      category,\r\n      validatedStock,\r\n      photoUrl,\r\n    ]);\r\n\r\n    const productId = result.rows[0].product_id;\r\n\r\n    if (Array.isArray(variations) && variations.length > 0) {\r\n      for (const variation of variations) {\r\n        const { quality, quantity, price_home, price_supermarket, price_restaurant, price_fruver } = variation;\r\n\r\n        if (!quality || !quantity) continue;\r\n\r\n        await client.query(queries.products.createProductVariation, [\r\n          productId,\r\n          quality,\r\n          quantity,\r\n          parseFloat(price_home || 0),\r\n          parseFloat(price_supermarket || 0),\r\n          parseFloat(price_restaurant || 0),\r\n          parseFloat(price_fruver || 0),\r\n        ]);\r\n      }\r\n    }\r\n\r\n    res.status(201).json({\r\n      message: 'Producto creado exitosamente',\r\n      product_id: productId,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ message: 'Error al crear el producto', error: error.message });\r\n  } finally {\r\n    if (client) client.release();\r\n  }\r\n};\r\n\r\nconst uploadImageSafe = async (buffer, filename) => {\r\n  try {\r\n    return await uploadImage(buffer, filename);\r\n  } catch (error) {\r\n    console.error('Error al subir la imagen:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\nexport const updateProduct = async (req, res) => {\r\n  let client;\r\n  const { id } = req.params;  \r\n  const { name, description, category, stock, photo_url, variations } = req.body;\r\n\r\n  const parsedProductId = parseInt(id, 10);\r\n\r\n  if (isNaN(parsedProductId)) {\r\n    return res.status(400).json({ message: 'ID del producto invÃ¡lido' });\r\n  }\r\n\r\n  try {\r\n    client = await getConnection();\r\n    const updatedPhotoUrl = photo_url || null;\r\n\r\n    if (!queries.products.updateProduct) {\r\n      return res.status(500).json({ message: 'Error en la consulta SQL' });\r\n    }\r\n\r\n    const result = await client.query(queries.products.updateProduct, [\r\n      name,\r\n      description,\r\n      category,\r\n      stock,\r\n      updatedPhotoUrl,  \r\n      parsedProductId,  \r\n    ]);\r\n\r\n    if (result.rowCount === 0) {\r\n      return res.status(404).json({ message: 'Producto no encontrado' });\r\n    }\r\n\r\n    if (Array.isArray(variations) && variations.length > 0) {\r\n      await client.query(queries.products.deleteProductVariation, [parsedProductId]);\r\n\r\n      for (const variation of variations) {\r\n        await client.query(queries.products.createProductVariation, [\r\n          parsedProductId,\r\n          variation.quality,\r\n          variation.quantity,\r\n          parseFloat(variation.price_home || 0),\r\n          parseFloat(variation.price_supermarket || 0),\r\n          parseFloat(variation.price_restaurant || 0),\r\n          parseFloat(variation.price_fruver || 0),\r\n        ]);\r\n      }\r\n    }\r\n\r\n    res.status(200).json({ message: 'Producto actualizado exitosamente' });\r\n  } catch (error) {\r\n    console.error('Error al actualizar el producto:', error);\r\n    res.status(500).json({ message: 'Error al actualizar el producto' });\r\n  } finally {\r\n    if (client) client.release();\r\n  }\r\n};\r\n\r\nexport const deleteProduct = async (req, res) => {\r\n  const { id } = req.params;  \r\n  let client;\r\n\r\n  if (!id) {\r\n    return res.status(400).json({ message: 'El ID del producto es requerido' });\r\n  }\r\n\r\n  try {\r\n    client = await getConnection();\r\n    const result = await client.query(queries.products.deleteProduct, [id]);\r\n\r\n    if (result.rowCount === 0) {\r\n      return res.status(404).json({ message: 'Producto no encontrado o ya eliminado' });\r\n    }\r\n\r\n    res.status(200).json({ message: 'Producto eliminado correctamente' });\r\n  } catch (error) {\r\n    console.error('Error al eliminar el producto:', error);\r\n    res.status(500).json({ message: 'Error al eliminar el producto' });\r\n  } finally {\r\n    if (client) client.release();\r\n  }\r\n};\r\n"],"mappings":"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","ignoreList":[]}