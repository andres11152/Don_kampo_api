{"version":3,"file":"products.controller.js","names":["getConnection","uploadImage","queries","getProducts","req","res","page","limit","query","offset","client","productsResult","products","rows","length","status","json","message","productsWithVariations","forEach","row","existingProduct","find","product","product_id","variations","push","variation_id","quality","quantity","price_home","price_supermarket","price_restaurant","price_fruver","name","description","category","stock","photo_url","error","console","release","getProductById","id","params","productResult","variationsResult","getProductVariations","productWithVariations","createProduct","_req$file","body","photoBuffer","file","buffer","defaultPhotoUrl","photoUrl","originalname","validatedStock","parseInt","result","productId","Array","isArray","variation","createProductVariation","parseFloat","uploadImageSafe","filename","updateProduct","parsedProductId","isNaN","updatedPhotoUrl","rowCount","deleteProductVariation","deleteProduct"],"sources":["../../src/controllers/products.controller.js"],"sourcesContent":["import { getConnection } from '../database/connection.js';\r\nimport { uploadImage } from '../helpers/uploadImage.js'; \r\nimport { queries } from '../database/queries.interface.js';\r\n\r\nexport const getProducts = async (req, res) => {\r\n  const { page = 1, limit = 9 } = req.query;\r\n  const offset = (page - 1) * limit;\r\n\r\n  let client;\r\n  try {\r\n    client = await getConnection();\r\n\r\n    const productsResult = await client.query(queries.products.getProducts, [offset, limit]);\r\n\r\n    if (productsResult.rows.length === 0) {\r\n      return res.status(404).json({ message: 'No hay productos disponibles' });\r\n    }\r\n\r\n    const productsWithVariations = [];\r\n\r\n    productsResult.rows.forEach((row) => {\r\n      const existingProduct = productsWithVariations.find((product) => product.product_id === row.product_id);\r\n\r\n      if (existingProduct) {\r\n        existingProduct.variations.push({\r\n          variation_id: row.variation_id,\r\n          quality: row.quality,\r\n          quantity: row.quantity,\r\n          price_home: row.price_home,\r\n          price_supermarket: row.price_supermarket,\r\n          price_restaurant: row.price_restaurant,\r\n          price_fruver: row.price_fruver,\r\n        });\r\n      } else {\r\n        productsWithVariations.push({\r\n          product_id: row.product_id,\r\n          name: row.name,\r\n          description: row.description,\r\n          category: row.category,\r\n          stock: row.stock,\r\n          photo_url: row.photo_url,\r\n          variations: row.variation_id\r\n            ? [\r\n                {\r\n                  variation_id: row.variation_id,\r\n                  quality: row.quality,\r\n                  quantity: row.quantity,\r\n                  price_home: row.price_home,\r\n                  price_supermarket: row.price_supermarket,\r\n                  price_restaurant: row.price_restaurant,\r\n                  price_fruver: row.price_fruver,\r\n                },\r\n              ]\r\n            : [],\r\n        });\r\n      }\r\n    });\r\n\r\n    res.status(200).json(productsWithVariations);\r\n\r\n  } catch (error) {\r\n    console.error('Error al obtener los productos:', error);\r\n    res.status(500).json({ message: 'Error al obtener los productos' });\r\n  } finally {\r\n    if (client) client.release();\r\n  }\r\n};\r\n\r\nexport const getProductById = async (req, res) => {\r\n  const { id } = req.params;  \r\n\r\n  let client;\r\n  try {\r\n    client = await getConnection();  \r\n\r\n    const productResult = await client.query(queries.products.getProductById, [id]);\r\n\r\n    if (productResult.rows.length === 0) {\r\n      return res.status(404).json({ message: 'Producto no encontrado' });\r\n    }\r\n\r\n    const variationsResult = await client.query(queries.products.getProductVariations, [id]);\r\n  \r\n    const productWithVariations = {\r\n      ...productResult.rows[0], \r\n      variations: variationsResult.rows  \r\n    };\r\n\r\n    res.status(200).json(productWithVariations);\r\n  } catch (error) {\r\n    console.error('Error al obtener el producto por ID:', error);\r\n    res.status(500).json({ message: 'Error al obtener el producto' });\r\n  } finally {\r\n    if (client) client.release();  \r\n  }\r\n};\r\n\r\nexport const createProduct = async (req, res) => {\r\n  let client;\r\n\r\n  const { name, description, category, stock, variations } = req.body;\r\n\r\n  const photoBuffer = req.file?.buffer || null;\r\n  const defaultPhotoUrl = 'https://example.com/default-image.jpg';\r\n  let photoUrl = null;\r\n\r\n  if (photoBuffer) {\r\n    try {\r\n      photoUrl = await uploadImage(photoBuffer, req.file.originalname);\r\n    } catch (error) {\r\n      return res.status(500).json({ message: 'Error al subir la imagen a S3' });\r\n    }\r\n  } else {\r\n    photoUrl = defaultPhotoUrl;\r\n  }\r\n\r\n  const validatedStock = stock ? parseInt(stock, 10) : 0;\r\n\r\n  try {\r\n    client = await getConnection();\r\n\r\n    const result = await client.query(queries.products.createProduct, [\r\n      name,\r\n      description,\r\n      category,\r\n      validatedStock,\r\n      photoUrl,\r\n    ]);\r\n\r\n    const productId = result.rows[0].product_id;\r\n\r\n    if (Array.isArray(variations) && variations.length > 0) {\r\n      for (const variation of variations) {\r\n        const { quality, quantity, price_home, price_supermarket, price_restaurant, price_fruver } = variation;\r\n\r\n        if (!quality || !quantity) continue;\r\n\r\n        await client.query(queries.products.createProductVariation, [\r\n          productId,\r\n          quality,\r\n          quantity,\r\n          parseFloat(price_home || 0),\r\n          parseFloat(price_supermarket || 0),\r\n          parseFloat(price_restaurant || 0),\r\n          parseFloat(price_fruver || 0),\r\n        ]);\r\n      }\r\n    }\r\n\r\n    res.status(201).json({\r\n      message: 'Producto creado exitosamente',\r\n      product_id: productId,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ message: 'Error al crear el producto', error: error.message });\r\n  } finally {\r\n    if (client) client.release();\r\n  }\r\n};\r\n\r\nconst uploadImageSafe = async (buffer, filename) => {\r\n  try {\r\n    return await uploadImage(buffer, filename);\r\n  } catch (error) {\r\n    console.error('Error al subir la imagen:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\nexport const updateProduct = async (req, res) => {\r\n  let client;\r\n  const { id } = req.params;  \r\n  const { name, description, category, stock, photo_url, variations } = req.body;\r\n\r\n  const parsedProductId = parseInt(id, 10);\r\n\r\n  if (isNaN(parsedProductId)) {\r\n    return res.status(400).json({ message: 'ID del producto invÃ¡lido' });\r\n  }\r\n\r\n  try {\r\n    client = await getConnection();\r\n    const updatedPhotoUrl = photo_url || null;\r\n\r\n    if (!queries.products.updateProduct) {\r\n      return res.status(500).json({ message: 'Error en la consulta SQL' });\r\n    }\r\n\r\n    const result = await client.query(queries.products.updateProduct, [\r\n      name,\r\n      description,\r\n      category,\r\n      stock,\r\n      updatedPhotoUrl,  \r\n      parsedProductId,  \r\n    ]);\r\n\r\n    if (result.rowCount === 0) {\r\n      return res.status(404).json({ message: 'Producto no encontrado' });\r\n    }\r\n\r\n    if (Array.isArray(variations) && variations.length > 0) {\r\n      await client.query(queries.products.deleteProductVariation, [parsedProductId]);\r\n\r\n      for (const variation of variations) {\r\n        await client.query(queries.products.createProductVariation, [\r\n          parsedProductId,\r\n          variation.quality,\r\n          variation.quantity,\r\n          parseFloat(variation.price_home || 0),\r\n          parseFloat(variation.price_supermarket || 0),\r\n          parseFloat(variation.price_restaurant || 0),\r\n          parseFloat(variation.price_fruver || 0),\r\n        ]);\r\n      }\r\n    }\r\n\r\n    res.status(200).json({ message: 'Producto actualizado exitosamente' });\r\n  } catch (error) {\r\n    console.error('Error al actualizar el producto:', error);\r\n    res.status(500).json({ message: 'Error al actualizar el producto' });\r\n  } finally {\r\n    if (client) client.release();\r\n  }\r\n};\r\n\r\nexport const deleteProduct = async (req, res) => {\r\n  const { id } = req.params;  \r\n  let client;\r\n\r\n  if (!id) {\r\n    return res.status(400).json({ message: 'El ID del producto es requerido' });\r\n  }\r\n\r\n  try {\r\n    client = await getConnection();\r\n    const result = await client.query(queries.products.deleteProduct, [id]);\r\n\r\n    if (result.rowCount === 0) {\r\n      return res.status(404).json({ message: 'Producto no encontrado o ya eliminado' });\r\n    }\r\n\r\n    res.status(200).json({ message: 'Producto eliminado correctamente' });\r\n  } catch (error) {\r\n    console.error('Error al eliminar el producto:', error);\r\n    res.status(500).json({ message: 'Error al eliminar el producto' });\r\n  } finally {\r\n    if (client) client.release();\r\n  }\r\n};\r\n"],"mappings":"AAAA,SAASA,aAAa,QAAQ,2BAA2B;AACzD,SAASC,WAAW,QAAQ,2BAA2B;AACvD,SAASC,OAAO,QAAQ,kCAAkC;AAE1D,OAAO,MAAMC,WAAW,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,KAAK;EAC7C,MAAM;IAAEC,IAAI,GAAG,CAAC;IAAEC,KAAK,GAAG;EAAE,CAAC,GAAGH,GAAG,CAACI,KAAK;EACzC,MAAMC,MAAM,GAAG,CAACH,IAAI,GAAG,CAAC,IAAIC,KAAK;EAEjC,IAAIG,MAAM;EACV,IAAI;IACFA,MAAM,GAAG,MAAMV,aAAa,CAAC,CAAC;IAE9B,MAAMW,cAAc,GAAG,MAAMD,MAAM,CAACF,KAAK,CAACN,OAAO,CAACU,QAAQ,CAACT,WAAW,EAAE,CAACM,MAAM,EAAEF,KAAK,CAAC,CAAC;IAExF,IAAII,cAAc,CAACE,IAAI,CAACC,MAAM,KAAK,CAAC,EAAE;MACpC,OAAOT,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAA+B,CAAC,CAAC;IAC1E;IAEA,MAAMC,sBAAsB,GAAG,EAAE;IAEjCP,cAAc,CAACE,IAAI,CAACM,OAAO,CAAEC,GAAG,IAAK;MACnC,MAAMC,eAAe,GAAGH,sBAAsB,CAACI,IAAI,CAAEC,OAAO,IAAKA,OAAO,CAACC,UAAU,KAAKJ,GAAG,CAACI,UAAU,CAAC;MAEvG,IAAIH,eAAe,EAAE;QACnBA,eAAe,CAACI,UAAU,CAACC,IAAI,CAAC;UAC9BC,YAAY,EAAEP,GAAG,CAACO,YAAY;UAC9BC,OAAO,EAAER,GAAG,CAACQ,OAAO;UACpBC,QAAQ,EAAET,GAAG,CAACS,QAAQ;UACtBC,UAAU,EAAEV,GAAG,CAACU,UAAU;UAC1BC,iBAAiB,EAAEX,GAAG,CAACW,iBAAiB;UACxCC,gBAAgB,EAAEZ,GAAG,CAACY,gBAAgB;UACtCC,YAAY,EAAEb,GAAG,CAACa;QACpB,CAAC,CAAC;MACJ,CAAC,MAAM;QACLf,sBAAsB,CAACQ,IAAI,CAAC;UAC1BF,UAAU,EAAEJ,GAAG,CAACI,UAAU;UAC1BU,IAAI,EAAEd,GAAG,CAACc,IAAI;UACdC,WAAW,EAAEf,GAAG,CAACe,WAAW;UAC5BC,QAAQ,EAAEhB,GAAG,CAACgB,QAAQ;UACtBC,KAAK,EAAEjB,GAAG,CAACiB,KAAK;UAChBC,SAAS,EAAElB,GAAG,CAACkB,SAAS;UACxBb,UAAU,EAAEL,GAAG,CAACO,YAAY,GACxB,CACE;YACEA,YAAY,EAAEP,GAAG,CAACO,YAAY;YAC9BC,OAAO,EAAER,GAAG,CAACQ,OAAO;YACpBC,QAAQ,EAAET,GAAG,CAACS,QAAQ;YACtBC,UAAU,EAAEV,GAAG,CAACU,UAAU;YAC1BC,iBAAiB,EAAEX,GAAG,CAACW,iBAAiB;YACxCC,gBAAgB,EAAEZ,GAAG,CAACY,gBAAgB;YACtCC,YAAY,EAAEb,GAAG,CAACa;UACpB,CAAC,CACF,GACD;QACN,CAAC,CAAC;MACJ;IACF,CAAC,CAAC;IAEF5B,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACE,sBAAsB,CAAC;EAE9C,CAAC,CAAC,OAAOqB,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;IACvDlC,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAiC,CAAC,CAAC;EACrE,CAAC,SAAS;IACR,IAAIP,MAAM,EAAEA,MAAM,CAAC+B,OAAO,CAAC,CAAC;EAC9B;AACF,CAAC;AAED,OAAO,MAAMC,cAAc,GAAG,MAAAA,CAAOtC,GAAG,EAAEC,GAAG,KAAK;EAChD,MAAM;IAAEsC;EAAG,CAAC,GAAGvC,GAAG,CAACwC,MAAM;EAEzB,IAAIlC,MAAM;EACV,IAAI;IACFA,MAAM,GAAG,MAAMV,aAAa,CAAC,CAAC;IAE9B,MAAM6C,aAAa,GAAG,MAAMnC,MAAM,CAACF,KAAK,CAACN,OAAO,CAACU,QAAQ,CAAC8B,cAAc,EAAE,CAACC,EAAE,CAAC,CAAC;IAE/E,IAAIE,aAAa,CAAChC,IAAI,CAACC,MAAM,KAAK,CAAC,EAAE;MACnC,OAAOT,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAAyB,CAAC,CAAC;IACpE;IAEA,MAAM6B,gBAAgB,GAAG,MAAMpC,MAAM,CAACF,KAAK,CAACN,OAAO,CAACU,QAAQ,CAACmC,oBAAoB,EAAE,CAACJ,EAAE,CAAC,CAAC;IAExF,MAAMK,qBAAqB,GAAG;MAC5B,GAAGH,aAAa,CAAChC,IAAI,CAAC,CAAC,CAAC;MACxBY,UAAU,EAAEqB,gBAAgB,CAACjC;IAC/B,CAAC;IAEDR,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACgC,qBAAqB,CAAC;EAC7C,CAAC,CAAC,OAAOT,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,sCAAsC,EAAEA,KAAK,CAAC;IAC5DlC,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAA+B,CAAC,CAAC;EACnE,CAAC,SAAS;IACR,IAAIP,MAAM,EAAEA,MAAM,CAAC+B,OAAO,CAAC,CAAC;EAC9B;AACF,CAAC;AAED,OAAO,MAAMQ,aAAa,GAAG,MAAAA,CAAO7C,GAAG,EAAEC,GAAG,KAAK;EAAA,IAAA6C,SAAA;EAC/C,IAAIxC,MAAM;EAEV,MAAM;IAAEwB,IAAI;IAAEC,WAAW;IAAEC,QAAQ;IAAEC,KAAK;IAAEZ;EAAW,CAAC,GAAGrB,GAAG,CAAC+C,IAAI;EAEnE,MAAMC,WAAW,GAAG,EAAAF,SAAA,GAAA9C,GAAG,CAACiD,IAAI,cAAAH,SAAA,uBAARA,SAAA,CAAUI,MAAM,KAAI,IAAI;EAC5C,MAAMC,eAAe,GAAG,uCAAuC;EAC/D,IAAIC,QAAQ,GAAG,IAAI;EAEnB,IAAIJ,WAAW,EAAE;IACf,IAAI;MACFI,QAAQ,GAAG,MAAMvD,WAAW,CAACmD,WAAW,EAAEhD,GAAG,CAACiD,IAAI,CAACI,YAAY,CAAC;IAClE,CAAC,CAAC,OAAOlB,KAAK,EAAE;MACd,OAAOlC,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAAgC,CAAC,CAAC;IAC3E;EACF,CAAC,MAAM;IACLuC,QAAQ,GAAGD,eAAe;EAC5B;EAEA,MAAMG,cAAc,GAAGrB,KAAK,GAAGsB,QAAQ,CAACtB,KAAK,EAAE,EAAE,CAAC,GAAG,CAAC;EAEtD,IAAI;IACF3B,MAAM,GAAG,MAAMV,aAAa,CAAC,CAAC;IAE9B,MAAM4D,MAAM,GAAG,MAAMlD,MAAM,CAACF,KAAK,CAACN,OAAO,CAACU,QAAQ,CAACqC,aAAa,EAAE,CAChEf,IAAI,EACJC,WAAW,EACXC,QAAQ,EACRsB,cAAc,EACdF,QAAQ,CACT,CAAC;IAEF,MAAMK,SAAS,GAAGD,MAAM,CAAC/C,IAAI,CAAC,CAAC,CAAC,CAACW,UAAU;IAE3C,IAAIsC,KAAK,CAACC,OAAO,CAACtC,UAAU,CAAC,IAAIA,UAAU,CAACX,MAAM,GAAG,CAAC,EAAE;MACtD,KAAK,MAAMkD,SAAS,IAAIvC,UAAU,EAAE;QAClC,MAAM;UAAEG,OAAO;UAAEC,QAAQ;UAAEC,UAAU;UAAEC,iBAAiB;UAAEC,gBAAgB;UAAEC;QAAa,CAAC,GAAG+B,SAAS;QAEtG,IAAI,CAACpC,OAAO,IAAI,CAACC,QAAQ,EAAE;QAE3B,MAAMnB,MAAM,CAACF,KAAK,CAACN,OAAO,CAACU,QAAQ,CAACqD,sBAAsB,EAAE,CAC1DJ,SAAS,EACTjC,OAAO,EACPC,QAAQ,EACRqC,UAAU,CAACpC,UAAU,IAAI,CAAC,CAAC,EAC3BoC,UAAU,CAACnC,iBAAiB,IAAI,CAAC,CAAC,EAClCmC,UAAU,CAAClC,gBAAgB,IAAI,CAAC,CAAC,EACjCkC,UAAU,CAACjC,YAAY,IAAI,CAAC,CAAC,CAC9B,CAAC;MACJ;IACF;IAEA5B,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MACnBC,OAAO,EAAE,8BAA8B;MACvCO,UAAU,EAAEqC;IACd,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOtB,KAAK,EAAE;IACdlC,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE,4BAA4B;MAAEsB,KAAK,EAAEA,KAAK,CAACtB;IAAQ,CAAC,CAAC;EACvF,CAAC,SAAS;IACR,IAAIP,MAAM,EAAEA,MAAM,CAAC+B,OAAO,CAAC,CAAC;EAC9B;AACF,CAAC;AAED,MAAM0B,eAAe,GAAG,MAAAA,CAAOb,MAAM,EAAEc,QAAQ,KAAK;EAClD,IAAI;IACF,OAAO,MAAMnE,WAAW,CAACqD,MAAM,EAAEc,QAAQ,CAAC;EAC5C,CAAC,CAAC,OAAO7B,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;IACjD,OAAO,IAAI;EACb;AACF,CAAC;AAED,OAAO,MAAM8B,aAAa,GAAG,MAAAA,CAAOjE,GAAG,EAAEC,GAAG,KAAK;EAC/C,IAAIK,MAAM;EACV,MAAM;IAAEiC;EAAG,CAAC,GAAGvC,GAAG,CAACwC,MAAM;EACzB,MAAM;IAAEV,IAAI;IAAEC,WAAW;IAAEC,QAAQ;IAAEC,KAAK;IAAEC,SAAS;IAAEb;EAAW,CAAC,GAAGrB,GAAG,CAAC+C,IAAI;EAE9E,MAAMmB,eAAe,GAAGX,QAAQ,CAAChB,EAAE,EAAE,EAAE,CAAC;EAExC,IAAI4B,KAAK,CAACD,eAAe,CAAC,EAAE;IAC1B,OAAOjE,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAA2B,CAAC,CAAC;EACtE;EAEA,IAAI;IACFP,MAAM,GAAG,MAAMV,aAAa,CAAC,CAAC;IAC9B,MAAMwE,eAAe,GAAGlC,SAAS,IAAI,IAAI;IAEzC,IAAI,CAACpC,OAAO,CAACU,QAAQ,CAACyD,aAAa,EAAE;MACnC,OAAOhE,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAA2B,CAAC,CAAC;IACtE;IAEA,MAAM2C,MAAM,GAAG,MAAMlD,MAAM,CAACF,KAAK,CAACN,OAAO,CAACU,QAAQ,CAACyD,aAAa,EAAE,CAChEnC,IAAI,EACJC,WAAW,EACXC,QAAQ,EACRC,KAAK,EACLmC,eAAe,EACfF,eAAe,CAChB,CAAC;IAEF,IAAIV,MAAM,CAACa,QAAQ,KAAK,CAAC,EAAE;MACzB,OAAOpE,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAAyB,CAAC,CAAC;IACpE;IAEA,IAAI6C,KAAK,CAACC,OAAO,CAACtC,UAAU,CAAC,IAAIA,UAAU,CAACX,MAAM,GAAG,CAAC,EAAE;MACtD,MAAMJ,MAAM,CAACF,KAAK,CAACN,OAAO,CAACU,QAAQ,CAAC8D,sBAAsB,EAAE,CAACJ,eAAe,CAAC,CAAC;MAE9E,KAAK,MAAMN,SAAS,IAAIvC,UAAU,EAAE;QAClC,MAAMf,MAAM,CAACF,KAAK,CAACN,OAAO,CAACU,QAAQ,CAACqD,sBAAsB,EAAE,CAC1DK,eAAe,EACfN,SAAS,CAACpC,OAAO,EACjBoC,SAAS,CAACnC,QAAQ,EAClBqC,UAAU,CAACF,SAAS,CAAClC,UAAU,IAAI,CAAC,CAAC,EACrCoC,UAAU,CAACF,SAAS,CAACjC,iBAAiB,IAAI,CAAC,CAAC,EAC5CmC,UAAU,CAACF,SAAS,CAAChC,gBAAgB,IAAI,CAAC,CAAC,EAC3CkC,UAAU,CAACF,SAAS,CAAC/B,YAAY,IAAI,CAAC,CAAC,CACxC,CAAC;MACJ;IACF;IAEA5B,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAoC,CAAC,CAAC;EACxE,CAAC,CAAC,OAAOsB,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;IACxDlC,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAkC,CAAC,CAAC;EACtE,CAAC,SAAS;IACR,IAAIP,MAAM,EAAEA,MAAM,CAAC+B,OAAO,CAAC,CAAC;EAC9B;AACF,CAAC;AAED,OAAO,MAAMkC,aAAa,GAAG,MAAAA,CAAOvE,GAAG,EAAEC,GAAG,KAAK;EAC/C,MAAM;IAAEsC;EAAG,CAAC,GAAGvC,GAAG,CAACwC,MAAM;EACzB,IAAIlC,MAAM;EAEV,IAAI,CAACiC,EAAE,EAAE;IACP,OAAOtC,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAkC,CAAC,CAAC;EAC7E;EAEA,IAAI;IACFP,MAAM,GAAG,MAAMV,aAAa,CAAC,CAAC;IAC9B,MAAM4D,MAAM,GAAG,MAAMlD,MAAM,CAACF,KAAK,CAACN,OAAO,CAACU,QAAQ,CAAC+D,aAAa,EAAE,CAAChC,EAAE,CAAC,CAAC;IAEvE,IAAIiB,MAAM,CAACa,QAAQ,KAAK,CAAC,EAAE;MACzB,OAAOpE,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAAwC,CAAC,CAAC;IACnF;IAEAZ,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAmC,CAAC,CAAC;EACvE,CAAC,CAAC,OAAOsB,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;IACtDlC,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAgC,CAAC,CAAC;EACpE,CAAC,SAAS;IACR,IAAIP,MAAM,EAAEA,MAAM,CAAC+B,OAAO,CAAC,CAAC;EAC9B;AACF,CAAC","ignoreList":[]}