{"version":3,"file":"products.controller.js","names":["getConnection","uploadImage","queries","getProducts","_ref","_asyncToGenerator","req","res","page","limit","query","offset","client","productsResult","products","rows","length","status","json","message","productsWithVariations","forEach","row","existingProduct","find","product","product_id","variations","push","variation_id","quality","quantity","price_home","price_supermarket","price_restaurant","price_fruver","name","description","category","stock","photo_url","error","console","release","_x","_x2","apply","arguments","getProductById","_ref2","id","params","productResult","variationsResult","getProductVariations","productWithVariations","_x3","_x4","createProduct","_ref3","_req$file","body","photoBuffer","file","buffer","defaultPhotoUrl","photoUrl","originalname","validatedStock","parseInt","result","productId","Array","isArray","variation","createProductVariation","parseFloat","_x5","_x6","uploadImageSafe","_ref4","filename","_x7","_x8","updateProduct","_ref5","parsedProductId","isNaN","updatedPhotoUrl","rowCount","deleteProductVariation","_x9","_x10","deleteProduct","_ref6","_x11","_x12"],"sources":["../../src/controllers/products.controller.js"],"sourcesContent":["import { getConnection } from '../database/connection.js';\r\nimport { uploadImage } from '../helpers/uploadImage.js'; \r\nimport { queries } from '../database/queries.interface.js';\r\n\r\nexport const getProducts = async (req, res) => {\r\n  const { page = 1, limit = 9 } = req.query;\r\n  const offset = (page - 1) * limit;\r\n\r\n  let client;\r\n  try {\r\n    client = await getConnection();\r\n\r\n    const productsResult = await client.query(queries.products.getProducts, [offset, limit]);\r\n\r\n    if (productsResult.rows.length === 0) {\r\n      return res.status(404).json({ message: 'No hay productos disponibles' });\r\n    }\r\n\r\n    const productsWithVariations = [];\r\n\r\n    productsResult.rows.forEach((row) => {\r\n      const existingProduct = productsWithVariations.find((product) => product.product_id === row.product_id);\r\n\r\n      if (existingProduct) {\r\n        existingProduct.variations.push({\r\n          variation_id: row.variation_id,\r\n          quality: row.quality,\r\n          quantity: row.quantity,\r\n          price_home: row.price_home,\r\n          price_supermarket: row.price_supermarket,\r\n          price_restaurant: row.price_restaurant,\r\n          price_fruver: row.price_fruver,\r\n        });\r\n      } else {\r\n        productsWithVariations.push({\r\n          product_id: row.product_id,\r\n          name: row.name,\r\n          description: row.description,\r\n          category: row.category,\r\n          stock: row.stock,\r\n          photo_url: row.photo_url,\r\n          variations: row.variation_id\r\n            ? [\r\n                {\r\n                  variation_id: row.variation_id,\r\n                  quality: row.quality,\r\n                  quantity: row.quantity,\r\n                  price_home: row.price_home,\r\n                  price_supermarket: row.price_supermarket,\r\n                  price_restaurant: row.price_restaurant,\r\n                  price_fruver: row.price_fruver,\r\n                },\r\n              ]\r\n            : [],\r\n        });\r\n      }\r\n    });\r\n\r\n    res.status(200).json(productsWithVariations);\r\n\r\n  } catch (error) {\r\n    console.error('Error al obtener los productos:', error);\r\n    res.status(500).json({ message: 'Error al obtener los productos' });\r\n  } finally {\r\n    if (client) client.release();\r\n  }\r\n};\r\n\r\nexport const getProductById = async (req, res) => {\r\n  const { id } = req.params;  \r\n\r\n  let client;\r\n  try {\r\n    client = await getConnection();  \r\n\r\n    const productResult = await client.query(queries.products.getProductById, [id]);\r\n\r\n    if (productResult.rows.length === 0) {\r\n      return res.status(404).json({ message: 'Producto no encontrado' });\r\n    }\r\n\r\n    const variationsResult = await client.query(queries.products.getProductVariations, [id]);\r\n  \r\n    const productWithVariations = {\r\n      ...productResult.rows[0], \r\n      variations: variationsResult.rows  \r\n    };\r\n\r\n    res.status(200).json(productWithVariations);\r\n  } catch (error) {\r\n    console.error('Error al obtener el producto por ID:', error);\r\n    res.status(500).json({ message: 'Error al obtener el producto' });\r\n  } finally {\r\n    if (client) client.release();  \r\n  }\r\n};\r\n\r\nexport const createProduct = async (req, res) => {\r\n  let client;\r\n\r\n  const { name, description, category, stock, variations } = req.body;\r\n\r\n  const photoBuffer = req.file?.buffer || null;\r\n  const defaultPhotoUrl = 'https://example.com/default-image.jpg';\r\n  let photoUrl = null;\r\n\r\n  if (photoBuffer) {\r\n    try {\r\n      photoUrl = await uploadImage(photoBuffer, req.file.originalname);\r\n    } catch (error) {\r\n      return res.status(500).json({ message: 'Error al subir la imagen a S3' });\r\n    }\r\n  } else {\r\n    photoUrl = defaultPhotoUrl;\r\n  }\r\n\r\n  const validatedStock = stock ? parseInt(stock, 10) : 0;\r\n\r\n  try {\r\n    client = await getConnection();\r\n\r\n    const result = await client.query(queries.products.createProduct, [\r\n      name,\r\n      description,\r\n      category,\r\n      validatedStock,\r\n      photoUrl,\r\n    ]);\r\n\r\n    const productId = result.rows[0].product_id;\r\n\r\n    if (Array.isArray(variations) && variations.length > 0) {\r\n      for (const variation of variations) {\r\n        const { quality, quantity, price_home, price_supermarket, price_restaurant, price_fruver } = variation;\r\n\r\n        if (!quality || !quantity) continue;\r\n\r\n        await client.query(queries.products.createProductVariation, [\r\n          productId,\r\n          quality,\r\n          quantity,\r\n          parseFloat(price_home || 0),\r\n          parseFloat(price_supermarket || 0),\r\n          parseFloat(price_restaurant || 0),\r\n          parseFloat(price_fruver || 0),\r\n        ]);\r\n      }\r\n    }\r\n\r\n    res.status(201).json({\r\n      message: 'Producto creado exitosamente',\r\n      product_id: productId,\r\n    });\r\n  } catch (error) {\r\n    res.status(500).json({ message: 'Error al crear el producto', error: error.message });\r\n  } finally {\r\n    if (client) client.release();\r\n  }\r\n};\r\n\r\nconst uploadImageSafe = async (buffer, filename) => {\r\n  try {\r\n    return await uploadImage(buffer, filename);\r\n  } catch (error) {\r\n    console.error('Error al subir la imagen:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\nexport const updateProduct = async (req, res) => {\r\n  let client;\r\n  const { id } = req.params;  \r\n  const { name, description, category, stock, photo_url, variations } = req.body;\r\n\r\n  const parsedProductId = parseInt(id, 10);\r\n\r\n  if (isNaN(parsedProductId)) {\r\n    return res.status(400).json({ message: 'ID del producto invÃ¡lido' });\r\n  }\r\n\r\n  try {\r\n    client = await getConnection();\r\n    const updatedPhotoUrl = photo_url || null;\r\n\r\n    if (!queries.products.updateProduct) {\r\n      return res.status(500).json({ message: 'Error en la consulta SQL' });\r\n    }\r\n\r\n    const result = await client.query(queries.products.updateProduct, [\r\n      name,\r\n      description,\r\n      category,\r\n      stock,\r\n      updatedPhotoUrl,  \r\n      parsedProductId,  \r\n    ]);\r\n\r\n    if (result.rowCount === 0) {\r\n      return res.status(404).json({ message: 'Producto no encontrado' });\r\n    }\r\n\r\n    if (Array.isArray(variations) && variations.length > 0) {\r\n      await client.query(queries.products.deleteProductVariation, [parsedProductId]);\r\n\r\n      for (const variation of variations) {\r\n        await client.query(queries.products.createProductVariation, [\r\n          parsedProductId,\r\n          variation.quality,\r\n          variation.quantity,\r\n          parseFloat(variation.price_home || 0),\r\n          parseFloat(variation.price_supermarket || 0),\r\n          parseFloat(variation.price_restaurant || 0),\r\n          parseFloat(variation.price_fruver || 0),\r\n        ]);\r\n      }\r\n    }\r\n\r\n    res.status(200).json({ message: 'Producto actualizado exitosamente' });\r\n  } catch (error) {\r\n    console.error('Error al actualizar el producto:', error);\r\n    res.status(500).json({ message: 'Error al actualizar el producto' });\r\n  } finally {\r\n    if (client) client.release();\r\n  }\r\n};\r\n\r\nexport const deleteProduct = async (req, res) => {\r\n  const { id } = req.params;  \r\n  let client;\r\n\r\n  if (!id) {\r\n    return res.status(400).json({ message: 'El ID del producto es requerido' });\r\n  }\r\n\r\n  try {\r\n    client = await getConnection();\r\n    const result = await client.query(queries.products.deleteProduct, [id]);\r\n\r\n    if (result.rowCount === 0) {\r\n      return res.status(404).json({ message: 'Producto no encontrado o ya eliminado' });\r\n    }\r\n\r\n    res.status(200).json({ message: 'Producto eliminado correctamente' });\r\n  } catch (error) {\r\n    console.error('Error al eliminar el producto:', error);\r\n    res.status(500).json({ message: 'Error al eliminar el producto' });\r\n  } finally {\r\n    if (client) client.release();\r\n  }\r\n};\r\n"],"mappings":";AAAA,SAASA,aAAa,QAAQ,2BAA2B;AACzD,SAASC,WAAW,QAAQ,2BAA2B;AACvD,SAASC,OAAO,QAAQ,kCAAkC;AAE1D,OAAO,MAAMC,WAAW;EAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAG,WAAOC,GAAG,EAAEC,GAAG,EAAK;IAC7C,MAAM;MAAEC,IAAI,GAAG,CAAC;MAAEC,KAAK,GAAG;IAAE,CAAC,GAAGH,GAAG,CAACI,KAAK;IACzC,MAAMC,MAAM,GAAG,CAACH,IAAI,GAAG,CAAC,IAAIC,KAAK;IAEjC,IAAIG,MAAM;IACV,IAAI;MACFA,MAAM,SAASZ,aAAa,CAAC,CAAC;MAE9B,MAAMa,cAAc,SAASD,MAAM,CAACF,KAAK,CAACR,OAAO,CAACY,QAAQ,CAACX,WAAW,EAAE,CAACQ,MAAM,EAAEF,KAAK,CAAC,CAAC;MAExF,IAAII,cAAc,CAACE,IAAI,CAACC,MAAM,KAAK,CAAC,EAAE;QACpC,OAAOT,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEC,OAAO,EAAE;QAA+B,CAAC,CAAC;MAC1E;MAEA,MAAMC,sBAAsB,GAAG,EAAE;MAEjCP,cAAc,CAACE,IAAI,CAACM,OAAO,CAAEC,GAAG,IAAK;QACnC,MAAMC,eAAe,GAAGH,sBAAsB,CAACI,IAAI,CAAEC,OAAO,IAAKA,OAAO,CAACC,UAAU,KAAKJ,GAAG,CAACI,UAAU,CAAC;QAEvG,IAAIH,eAAe,EAAE;UACnBA,eAAe,CAACI,UAAU,CAACC,IAAI,CAAC;YAC9BC,YAAY,EAAEP,GAAG,CAACO,YAAY;YAC9BC,OAAO,EAAER,GAAG,CAACQ,OAAO;YACpBC,QAAQ,EAAET,GAAG,CAACS,QAAQ;YACtBC,UAAU,EAAEV,GAAG,CAACU,UAAU;YAC1BC,iBAAiB,EAAEX,GAAG,CAACW,iBAAiB;YACxCC,gBAAgB,EAAEZ,GAAG,CAACY,gBAAgB;YACtCC,YAAY,EAAEb,GAAG,CAACa;UACpB,CAAC,CAAC;QACJ,CAAC,MAAM;UACLf,sBAAsB,CAACQ,IAAI,CAAC;YAC1BF,UAAU,EAAEJ,GAAG,CAACI,UAAU;YAC1BU,IAAI,EAAEd,GAAG,CAACc,IAAI;YACdC,WAAW,EAAEf,GAAG,CAACe,WAAW;YAC5BC,QAAQ,EAAEhB,GAAG,CAACgB,QAAQ;YACtBC,KAAK,EAAEjB,GAAG,CAACiB,KAAK;YAChBC,SAAS,EAAElB,GAAG,CAACkB,SAAS;YACxBb,UAAU,EAAEL,GAAG,CAACO,YAAY,GACxB,CACE;cACEA,YAAY,EAAEP,GAAG,CAACO,YAAY;cAC9BC,OAAO,EAAER,GAAG,CAACQ,OAAO;cACpBC,QAAQ,EAAET,GAAG,CAACS,QAAQ;cACtBC,UAAU,EAAEV,GAAG,CAACU,UAAU;cAC1BC,iBAAiB,EAAEX,GAAG,CAACW,iBAAiB;cACxCC,gBAAgB,EAAEZ,GAAG,CAACY,gBAAgB;cACtCC,YAAY,EAAEb,GAAG,CAACa;YACpB,CAAC,CACF,GACD;UACN,CAAC,CAAC;QACJ;MACF,CAAC,CAAC;MAEF5B,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACE,sBAAsB,CAAC;IAE9C,CAAC,CAAC,OAAOqB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;MACvDlC,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAAiC,CAAC,CAAC;IACrE,CAAC,SAAS;MACR,IAAIP,MAAM,EAAEA,MAAM,CAAC+B,OAAO,CAAC,CAAC;IAC9B;EACF,CAAC;EAAA,gBA9DYxC,WAAWA,CAAAyC,EAAA,EAAAC,GAAA;IAAA,OAAAzC,IAAA,CAAA0C,KAAA,OAAAC,SAAA;EAAA;AAAA,GA8DvB;AAED,OAAO,MAAMC,cAAc;EAAA,IAAAC,KAAA,GAAA5C,iBAAA,CAAG,WAAOC,GAAG,EAAEC,GAAG,EAAK;IAChD,MAAM;MAAE2C;IAAG,CAAC,GAAG5C,GAAG,CAAC6C,MAAM;IAEzB,IAAIvC,MAAM;IACV,IAAI;MACFA,MAAM,SAASZ,aAAa,CAAC,CAAC;MAE9B,MAAMoD,aAAa,SAASxC,MAAM,CAACF,KAAK,CAACR,OAAO,CAACY,QAAQ,CAACkC,cAAc,EAAE,CAACE,EAAE,CAAC,CAAC;MAE/E,IAAIE,aAAa,CAACrC,IAAI,CAACC,MAAM,KAAK,CAAC,EAAE;QACnC,OAAOT,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEC,OAAO,EAAE;QAAyB,CAAC,CAAC;MACpE;MAEA,MAAMkC,gBAAgB,SAASzC,MAAM,CAACF,KAAK,CAACR,OAAO,CAACY,QAAQ,CAACwC,oBAAoB,EAAE,CAACJ,EAAE,CAAC,CAAC;MAExF,MAAMK,qBAAqB,GAAG;QAC5B,GAAGH,aAAa,CAACrC,IAAI,CAAC,CAAC,CAAC;QACxBY,UAAU,EAAE0B,gBAAgB,CAACtC;MAC/B,CAAC;MAEDR,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACqC,qBAAqB,CAAC;IAC7C,CAAC,CAAC,OAAOd,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,sCAAsC,EAAEA,KAAK,CAAC;MAC5DlC,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAA+B,CAAC,CAAC;IACnE,CAAC,SAAS;MACR,IAAIP,MAAM,EAAEA,MAAM,CAAC+B,OAAO,CAAC,CAAC;IAC9B;EACF,CAAC;EAAA,gBA3BYK,cAAcA,CAAAQ,GAAA,EAAAC,GAAA;IAAA,OAAAR,KAAA,CAAAH,KAAA,OAAAC,SAAA;EAAA;AAAA,GA2B1B;AAED,OAAO,MAAMW,aAAa;EAAA,IAAAC,KAAA,GAAAtD,iBAAA,CAAG,WAAOC,GAAG,EAAEC,GAAG,EAAK;IAAA,IAAAqD,SAAA;IAC/C,IAAIhD,MAAM;IAEV,MAAM;MAAEwB,IAAI;MAAEC,WAAW;MAAEC,QAAQ;MAAEC,KAAK;MAAEZ;IAAW,CAAC,GAAGrB,GAAG,CAACuD,IAAI;IAEnE,MAAMC,WAAW,GAAG,EAAAF,SAAA,GAAAtD,GAAG,CAACyD,IAAI,cAAAH,SAAA,uBAARA,SAAA,CAAUI,MAAM,KAAI,IAAI;IAC5C,MAAMC,eAAe,GAAG,uCAAuC;IAC/D,IAAIC,QAAQ,GAAG,IAAI;IAEnB,IAAIJ,WAAW,EAAE;MACf,IAAI;QACFI,QAAQ,SAASjE,WAAW,CAAC6D,WAAW,EAAExD,GAAG,CAACyD,IAAI,CAACI,YAAY,CAAC;MAClE,CAAC,CAAC,OAAO1B,KAAK,EAAE;QACd,OAAOlC,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEC,OAAO,EAAE;QAAgC,CAAC,CAAC;MAC3E;IACF,CAAC,MAAM;MACL+C,QAAQ,GAAGD,eAAe;IAC5B;IAEA,MAAMG,cAAc,GAAG7B,KAAK,GAAG8B,QAAQ,CAAC9B,KAAK,EAAE,EAAE,CAAC,GAAG,CAAC;IAEtD,IAAI;MACF3B,MAAM,SAASZ,aAAa,CAAC,CAAC;MAE9B,MAAMsE,MAAM,SAAS1D,MAAM,CAACF,KAAK,CAACR,OAAO,CAACY,QAAQ,CAAC4C,aAAa,EAAE,CAChEtB,IAAI,EACJC,WAAW,EACXC,QAAQ,EACR8B,cAAc,EACdF,QAAQ,CACT,CAAC;MAEF,MAAMK,SAAS,GAAGD,MAAM,CAACvD,IAAI,CAAC,CAAC,CAAC,CAACW,UAAU;MAE3C,IAAI8C,KAAK,CAACC,OAAO,CAAC9C,UAAU,CAAC,IAAIA,UAAU,CAACX,MAAM,GAAG,CAAC,EAAE;QACtD,KAAK,MAAM0D,SAAS,IAAI/C,UAAU,EAAE;UAClC,MAAM;YAAEG,OAAO;YAAEC,QAAQ;YAAEC,UAAU;YAAEC,iBAAiB;YAAEC,gBAAgB;YAAEC;UAAa,CAAC,GAAGuC,SAAS;UAEtG,IAAI,CAAC5C,OAAO,IAAI,CAACC,QAAQ,EAAE;UAE3B,MAAMnB,MAAM,CAACF,KAAK,CAACR,OAAO,CAACY,QAAQ,CAAC6D,sBAAsB,EAAE,CAC1DJ,SAAS,EACTzC,OAAO,EACPC,QAAQ,EACR6C,UAAU,CAAC5C,UAAU,IAAI,CAAC,CAAC,EAC3B4C,UAAU,CAAC3C,iBAAiB,IAAI,CAAC,CAAC,EAClC2C,UAAU,CAAC1C,gBAAgB,IAAI,CAAC,CAAC,EACjC0C,UAAU,CAACzC,YAAY,IAAI,CAAC,CAAC,CAC9B,CAAC;QACJ;MACF;MAEA5B,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,8BAA8B;QACvCO,UAAU,EAAE6C;MACd,CAAC,CAAC;IACJ,CAAC,CAAC,OAAO9B,KAAK,EAAE;MACdlC,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE,4BAA4B;QAAEsB,KAAK,EAAEA,KAAK,CAACtB;MAAQ,CAAC,CAAC;IACvF,CAAC,SAAS;MACR,IAAIP,MAAM,EAAEA,MAAM,CAAC+B,OAAO,CAAC,CAAC;IAC9B;EACF,CAAC;EAAA,gBA7DYe,aAAaA,CAAAmB,GAAA,EAAAC,GAAA;IAAA,OAAAnB,KAAA,CAAAb,KAAA,OAAAC,SAAA;EAAA;AAAA,GA6DzB;AAED,MAAMgC,eAAe;EAAA,IAAAC,KAAA,GAAA3E,iBAAA,CAAG,WAAO2D,MAAM,EAAEiB,QAAQ,EAAK;IAClD,IAAI;MACF,aAAahF,WAAW,CAAC+D,MAAM,EAAEiB,QAAQ,CAAC;IAC5C,CAAC,CAAC,OAAOxC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;MACjD,OAAO,IAAI;IACb;EACF,CAAC;EAAA,gBAPKsC,eAAeA,CAAAG,GAAA,EAAAC,GAAA;IAAA,OAAAH,KAAA,CAAAlC,KAAA,OAAAC,SAAA;EAAA;AAAA,GAOpB;AAED,OAAO,MAAMqC,aAAa;EAAA,IAAAC,KAAA,GAAAhF,iBAAA,CAAG,WAAOC,GAAG,EAAEC,GAAG,EAAK;IAC/C,IAAIK,MAAM;IACV,MAAM;MAAEsC;IAAG,CAAC,GAAG5C,GAAG,CAAC6C,MAAM;IACzB,MAAM;MAAEf,IAAI;MAAEC,WAAW;MAAEC,QAAQ;MAAEC,KAAK;MAAEC,SAAS;MAAEb;IAAW,CAAC,GAAGrB,GAAG,CAACuD,IAAI;IAE9E,MAAMyB,eAAe,GAAGjB,QAAQ,CAACnB,EAAE,EAAE,EAAE,CAAC;IAExC,IAAIqC,KAAK,CAACD,eAAe,CAAC,EAAE;MAC1B,OAAO/E,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAA2B,CAAC,CAAC;IACtE;IAEA,IAAI;MACFP,MAAM,SAASZ,aAAa,CAAC,CAAC;MAC9B,MAAMwF,eAAe,GAAGhD,SAAS,IAAI,IAAI;MAEzC,IAAI,CAACtC,OAAO,CAACY,QAAQ,CAACsE,aAAa,EAAE;QACnC,OAAO7E,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEC,OAAO,EAAE;QAA2B,CAAC,CAAC;MACtE;MAEA,MAAMmD,MAAM,SAAS1D,MAAM,CAACF,KAAK,CAACR,OAAO,CAACY,QAAQ,CAACsE,aAAa,EAAE,CAChEhD,IAAI,EACJC,WAAW,EACXC,QAAQ,EACRC,KAAK,EACLiD,eAAe,EACfF,eAAe,CAChB,CAAC;MAEF,IAAIhB,MAAM,CAACmB,QAAQ,KAAK,CAAC,EAAE;QACzB,OAAOlF,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEC,OAAO,EAAE;QAAyB,CAAC,CAAC;MACpE;MAEA,IAAIqD,KAAK,CAACC,OAAO,CAAC9C,UAAU,CAAC,IAAIA,UAAU,CAACX,MAAM,GAAG,CAAC,EAAE;QACtD,MAAMJ,MAAM,CAACF,KAAK,CAACR,OAAO,CAACY,QAAQ,CAAC4E,sBAAsB,EAAE,CAACJ,eAAe,CAAC,CAAC;QAE9E,KAAK,MAAMZ,SAAS,IAAI/C,UAAU,EAAE;UAClC,MAAMf,MAAM,CAACF,KAAK,CAACR,OAAO,CAACY,QAAQ,CAAC6D,sBAAsB,EAAE,CAC1DW,eAAe,EACfZ,SAAS,CAAC5C,OAAO,EACjB4C,SAAS,CAAC3C,QAAQ,EAClB6C,UAAU,CAACF,SAAS,CAAC1C,UAAU,IAAI,CAAC,CAAC,EACrC4C,UAAU,CAACF,SAAS,CAACzC,iBAAiB,IAAI,CAAC,CAAC,EAC5C2C,UAAU,CAACF,SAAS,CAACxC,gBAAgB,IAAI,CAAC,CAAC,EAC3C0C,UAAU,CAACF,SAAS,CAACvC,YAAY,IAAI,CAAC,CAAC,CACxC,CAAC;QACJ;MACF;MAEA5B,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAAoC,CAAC,CAAC;IACxE,CAAC,CAAC,OAAOsB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;MACxDlC,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAAkC,CAAC,CAAC;IACtE,CAAC,SAAS;MACR,IAAIP,MAAM,EAAEA,MAAM,CAAC+B,OAAO,CAAC,CAAC;IAC9B;EACF,CAAC;EAAA,gBAvDYyC,aAAaA,CAAAO,GAAA,EAAAC,IAAA;IAAA,OAAAP,KAAA,CAAAvC,KAAA,OAAAC,SAAA;EAAA;AAAA,GAuDzB;AAED,OAAO,MAAM8C,aAAa;EAAA,IAAAC,KAAA,GAAAzF,iBAAA,CAAG,WAAOC,GAAG,EAAEC,GAAG,EAAK;IAC/C,MAAM;MAAE2C;IAAG,CAAC,GAAG5C,GAAG,CAAC6C,MAAM;IACzB,IAAIvC,MAAM;IAEV,IAAI,CAACsC,EAAE,EAAE;MACP,OAAO3C,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAAkC,CAAC,CAAC;IAC7E;IAEA,IAAI;MACFP,MAAM,SAASZ,aAAa,CAAC,CAAC;MAC9B,MAAMsE,MAAM,SAAS1D,MAAM,CAACF,KAAK,CAACR,OAAO,CAACY,QAAQ,CAAC+E,aAAa,EAAE,CAAC3C,EAAE,CAAC,CAAC;MAEvE,IAAIoB,MAAM,CAACmB,QAAQ,KAAK,CAAC,EAAE;QACzB,OAAOlF,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEC,OAAO,EAAE;QAAwC,CAAC,CAAC;MACnF;MAEAZ,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAAmC,CAAC,CAAC;IACvE,CAAC,CAAC,OAAOsB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;MACtDlC,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAAgC,CAAC,CAAC;IACpE,CAAC,SAAS;MACR,IAAIP,MAAM,EAAEA,MAAM,CAAC+B,OAAO,CAAC,CAAC;IAC9B;EACF,CAAC;EAAA,gBAvBYkD,aAAaA,CAAAE,IAAA,EAAAC,IAAA;IAAA,OAAAF,KAAA,CAAAhD,KAAA,OAAAC,SAAA;EAAA;AAAA,GAuBzB","ignoreList":[]}